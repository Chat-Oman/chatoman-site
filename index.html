<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatOman | Interactive Pricing Plans</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Added Tajawal font for Arabic text -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony - A warm neutral neutral palette (Stone) with a professional Teal accent for calls to action and highlights. -->
    <!-- Application Structure Plan: The SPA is designed as a conversion-focused landing page. It starts with a Hero section to establish value, followed by the core "Interactive Calculator" to engage users personally. A "Visual Comparison" chart provides a quick, data-driven overview. New "Detailed Pricing Overview" sections present comprehensive monthly, yearly, and setup fee tables. "Feature Explanations" and "Plan Suitability" sections educate the user and help them self-qualify. This structure guides the user from awareness to consideration and finally to a decision, ending with a clear CTA. This is more effective than a static table as it involves the user in the discovery process. -->
    <!-- Visualization & Content Choices: 1. Pricing Tiers -> Interactive Calculator (HTML/JS) -> Goal: Allow users to create a custom quote, making the price feel tangible and personalized. Interaction: Radio buttons for base plans and checkboxes for add-ons dynamically update the total. Justification: Increases engagement and ownership over the selection process. 2. Price vs. Credits -> Doughnut Charts (HTML/JS Canvas) -> Goal: Visually compare the feature distribution of each plan. Interaction: Static visual for quick comparison. Justification: Doughnut charts are excellent for showing parts of a whole, making it easy to see the focus of each plan. 3. Detailed Pricing Tables -> Static HTML Tables with Tailwind -> Goal: Provide comprehensive, at-a- glance information for all pricing structures (monthly, yearly, setup). Interaction: None, purely informational. Justification: Caters to users who prefer detailed tabular data for direct comparison. 4. Feature Details -> Accordion (HTML/JS) -> Goal: Explain technical terms simply without cluttering the UI. Interaction: Click to reveal. Justification: Progressive disclosure makes information more digestible for non-tech-savvy users. 5. FAQ Content Generator -> Text Input & Button with LLM Call (HTML/JS with Gemini API) -> Goal: Demonstrate the practical application of AI chatbots by generating example FAQ content, helping potential clients visualize the initial setup. Interaction: User inputs business type, clicks button, and receives AI-generated FAQs. Justification: Directly showcases the value proposition of a chatbot service and reduces a common friction point in chatbot adoption (content creation). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Add padding to the bottom of the body to prevent content from being hidden behind the sticky button */
            padding-bottom: 80px; /* Adjust as needed based on button height + margin */
        }
        /* Custom font family for Arabic text */
        .font-tajawal {
            font-family: 'Tajawal', sans-serif;
        }
        /* Language container styling */
        .lang-ar {
            font-family: 'Tajawal', sans-serif;
            direction: rtl;
            display: none; /* Hidden by default */
        }

        /* Pricing wrapper specific RTL styling */
        .pricing-wrapper-ar {
            direction: rtl;
            text-align: right;
        }

        .pricing-wrapper-ar .pricing-card {
            direction: rtl;
            text-align: right;
        }
        .lang-en {
            font-family: 'Inter', sans-serif;
            direction: ltr;
            display: block; /* Shown by default for English */
        }

        /* Language toggle active states */
        .lang-active {
            display: block !important;
        }

        .lang-inactive {
            display: none !important;
        }
        .plan-card { transition: all 0.3s ease-in-out; }
        .plan-card.selected { border-color: #0d9488; box-shadow: 0 10px 15px -3px rgb(13 148 136 / 0.1), 0 4px 6px -4px rgb(13 148 136 / 0.1); transform: translateY(-5px); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        /* Table specific styles for better readability */
        .table-auto { border-collapse: collapse; width: 100%; }
        .table-auto th, .table-auto td { padding: 0.75rem; text-align: left; border-bottom: 1px solid #e2e8f0; } /* stone-200 */
        .table-auto th { background-color: #f8fafc; font-weight: 600; text-transform: uppercase; font-size: 0.875rem; } /* slate-50 */
        .table-auto tbody tr:last-child td { border-bottom: none; }
        /* Language toggle positioning */
        #language-toggle {
            position: fixed;
            z-index: 50;
        }

        /* Mobile: bottom-left */
        @media (max-width: 767px) {
            #language-toggle {
                bottom: 1rem;
                left: 1rem;
                top: auto;
                right: auto;
            }
            #lang-dropdown {
                bottom: 3.5rem;
                left: 0;
                top: auto;
                right: auto;
            }
        }

        /* Desktop: top-right */
        @media (min-width: 768px) {
            #language-toggle {
                top: 1rem;
                right: 1rem;
                bottom: auto;
                left: auto;
            }
            #lang-dropdown {
                top: 3.5rem;
                right: 0;
                bottom: auto;
                left: auto;
            }
        }

        /* Sticky button styles for mobile (centered) */
        .sticky-get-started {
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 2rem); /* Full width minus padding */
            max-width: 300px; /* Limit width on larger mobiles */
        }
        /* Sticky button styles for desktop (bottom-left) */
        @media (min-width: 768px) {
            .sticky-get-started {
                left: 2rem; /* Adjusted to left: 2rem */
                right: auto; /* Removed right positioning */
                transform: none;
                width: auto;
                max-width: none;
            }
        }
        /* How It Works Card Hover Effect */
        .how-it-works-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .how-it-works-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
        }
        /* Why ChatOman Card Styling */
        .why-chatoman-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .why-chatoman-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
        }
        /* Toggle Switch Styling */
        .toggle-switch {
            display: flex;
            background-color: #e2e8f0; /* stone-200 */
            border-radius: 9999px;
            padding: 4px;
            width: 200px;
            margin: 0 auto 2rem auto;
            position: relative;
        }
        .toggle-switch button {
            flex: 1;
            padding: 8px 16px;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.3s ease;
            background-color: transparent;
            color: #4b5563; /* stone-600 */
            border: none;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }
        .toggle-switch button.active {
            color: #ffffff;
        }
        .toggle-switch .slider {
            position: absolute;
            top: 4px;
            left: 4px;
            height: calc(100% - 8px);
            width: calc(50% - 4px);
            background-color: #0d9488; /* teal-600 */
            border-radius: 9999px;
            transition: all 0.3s ease;
            z-index: 0;
        }
        .toggle-switch .slider.yearly {
            transform: translateX(100%);
        }
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 500px;
            position: relative;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
            opacity: 1;
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #4b5563; /* stone-600 */
        }
        /* Custom styles for doughnut charts */
        .doughnut-chart-canvas {
            width: 120px; /* Fixed size for the doughnut chart */
            height: 120px;
        }
        .shared-pie-legend {
            display: flex;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            justify-content: center;
            margin-top: 1.5rem; /* Increased margin for separation */
            font-size: 0.875rem; /* text-sm */
            color: #4b5563; /* stone-600 */
        }
        .pie-legend-item {
            display: flex;
            align-items: center;
            margin: 0 0.75rem; /* Increased margin for spacing */
        }
        .pie-legend-color {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.25rem;
        }
        /* Responsive stacking for stat cards */
        @media (max-width: 479px) { /* Screens less than 480px */
            #doughnut-charts-wrapper {
                flex-direction: column;
            }
            .flex-1 { /* Target individual cards */
                width: 100%; /* Take full width */
                margin-bottom: 1rem; /* Add vertical spacing */
            }
            .flex-1:last-child {
                margin-bottom: 0; /* No margin after the last card */
            }
            .flex-1 h5, .flex-1 .doughnut-chart-canvas, .flex-1 ul {
                text-align: center; /* Center align content within stacked cards */
                margin-left: auto;
                margin-right: auto;
            }
            .flex-1 ul {
                padding-left: 0; /* Remove default ul padding */
            }
            .flex-1 ul li {
                justify-content: center; /* Center dot bullets and text */
            }
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">

        <!-- Hero Banner Section Start -->
        <section id="hero-banner" class="text-center py-16 px-4 rounded-2xl mb-16" style="background-color: #f1f1f2;">
            <!-- English Version -->
            <div class="lang-en">
                <h1 class="text-4xl md:text-5xl font-bold mb-2" style="color: #070909;">
                    Smart Bilingual Chatbots for Omani Businesses
                </h1>
                <p class="text-lg md:text-xl text-stone-700 max-w-3xl mx-auto mb-6">
                    Instantly answer customer questions, show menus and services, and handle bookings — in Arabic and English.
                </p>
                <p class="text-md text-stone-600 max-w-2xl mx-auto mb-8">
                    ChatOman builds AI chatbots that save time, provide 24/7 customer support, and help your business grow.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-10 text-stone-700">
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/restaurant.svg" alt="Restaurant icon" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">Restaurants & Cafés</h3>
                        <p class="text-sm">Share menu, guide customers to order links, handle FAQs</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/shop.svg" alt="Retail store icon" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">Retail Stores</h3>
                        <p class="text-sm">Answer product questions, show locations, guide to offers</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/medical.svg" alt="Medical clinic icon" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">Clinics & Salons</h3>
                        <p class="text-sm">Assist with booking questions, explain services, answer common questions</p>
                    </div>
                </div>

                <button id="hero-get-started-btn" class="inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white transition-colors mt-8" style="background-color: #12bfb4; hover-bg-color: #0e9a8f;">
                    See How It Works
                </button>
            </div>

            <!-- Arabic Version -->
            <div class="lang-ar text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-2" style="color: #070909;">
                    روبوتات دردشة ذكية ثنائية اللغة للشركات العُمانية
                </h1>
                <p class="text-lg md:text-xl text-stone-700 max-w-3xl mx-auto mb-6">
                    الرد الفوري على استفسارات العملاء، عرض القوائم والخدمات، وإدارة الحجوزات — بالعربية والإنجليزية
                </p>
                <p class="text-md text-stone-600 max-w-2xl mx-auto mb-8">
                    تشات عُمان تصمّم روبوتات دردشة تعمل بالذكاء الاصطناعي لتوفير الوقت، ودعم العملاء على مدار الساعة، ومساعدة عملك على النمو
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-10 text-stone-700">
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/restaurant.svg" alt="أيقونة مطعم" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">المطاعم والمقاهي</h3>
                        <p class="text-sm">عرض القائمة، توجيه العملاء لروابط الطلب، الرد على الأسئلة الشائعة</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/shop.svg" alt="أيقونة متجر" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">متاجر التجزئة</h3>
                        <p class="text-sm">الرد على استفسارات المنتجات، عرض المواقع، وتوجيههم للعروض المتاحة</p>
                    </div>
                    <div class="p-4 bg-white rounded-lg shadow-sm">
                        <div class="w-12 h-12 mx-auto mb-3">
                            <img src="./assets/icons/medical.svg" alt="أيقونة عيادة طبية" class="w-full h-full">
                        </div>
                        <h3 class="font-semibold text-lg">العيادات والصالونات</h3>
                        <p class="text-sm">المساعدة في أسئلة الحجوزات، شرح الخدمات، والإجابة على الاستفسارات المتكررة</p>
                    </div>
                </div>

                <button id="hero-get-started-btn-ar" class="inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white transition-colors mt-8" style="background-color: #12bfb4; hover-bg-color: #0e9a8f;">
                    شاهد كيف يعمل
                </button>
            </div>
        </section>
        <!-- Hero Banner Section End -->

        <main>
            <!-- How It Works Section Start -->
            <section id="how-it-works" class="mb-20 text-center">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">How It Works</h2>
                        <p class="mt-2 text-md text-stone-600">Getting started with ChatOman is simple and straightforward</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                        <!-- Step 1 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/form.svg" alt="Form submission icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Step 1: Submit Your Info</h3>
                            <p class="text-sm text-stone-600">Fill out our simple onboarding form with your business details</p>
                        </div>
                        <!-- Step 2 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/chatbot.svg" alt="Chatbot building icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Step 2: We Build Your Chatbot</h3>
                            <p class="text-sm text-stone-600">Our team creates a custom chatbot in English and Arabic using your content</p>
                        </div>
                        <!-- Step 3 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/check.svg" alt="Approval check icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Step 3: Test & Approve</h3>
                            <p class="text-sm text-stone-600">You preview the chatbot, give feedback, and request edits if needed</p>
                        </div>
                        <!-- Step 4 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/rocket.svg" alt="Launch rocket icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Step 4: Go Live on Your Website</h3>
                            <p class="text-sm text-stone-600">We connect the chatbot to your site and you're ready to go!</p>
                        </div>
                    </div>

                    <button id="how-it-works-get-started-btn" class="inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white transition-colors mt-12" style="background-color: #12bfb4; hover-bg-color: #0e9a8f;">
                        Get Started
                    </button>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">طريقة العمل</h2>
                        <p class="mt-2 text-md text-stone-600">البدء مع تشات عُمان سهل ومباشر</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                        <!-- Step 1 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/form.svg" alt="أيقونة إرسال النموذج" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">الخطوة ١: أرسل معلوماتك</h3>
                            <p class="text-sm text-stone-600">املأ نموذج التسجيل بمعلومات عملك</p>
                        </div>
                        <!-- Step 2 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/chatbot.svg" alt="أيقونة بناء روبوت الدردشة" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">الخطوة ٢: نقوم ببناء روبوت الدردشة</h3>
                            <p class="text-sm text-stone-600">نقوم ببناء روبوت دردشة مخصص بلغتين باستخدام محتوى عملك</p>
                        </div>
                        <!-- Step 3 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/check.svg" alt="أيقونة الموافقة" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">الخطوة ٣: جرب ووافق</h3>
                            <p class="text-sm text-stone-600">جرب الروبوت، وأرسل ملاحظاتك، واطلب التعديلات إن وجدت</p>
                        </div>
                        <!-- Step 4 -->
                        <div class="how-it-works-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/rocket.svg" alt="أيقونة الإطلاق" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">الخطوة ٤: أطلقه على موقعك</h3>
                            <p class="text-sm text-stone-600">نقوم بربط الروبوت بموقعك الإلكتروني — وانطلق</p>
                        </div>
                    </div>

                    <button id="how-it-works-get-started-btn-ar" class="inline-flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white transition-colors mt-12" style="background-color: #12bfb4; hover-bg-color: #0e9a8f;">
                        ابدأ الآن
                    </button>
                </div>
            </section>
            <!-- How It Works Section End -->

            <!-- Why ChatOman Section Start -->
            <section id="why-chatoman" class="py-16 px-4 rounded-2xl mb-16" style="background-color: #f8fafc;">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">Why ChatOman?</h2>
                        <p class="mt-2 text-md text-stone-600">What makes our service unique and trusted by local businesses</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                        <!-- Card 1: Locally Trained AI -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/oman-pin.svg" alt="Oman location icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Locally Trained AI</h3>
                            <p class="text-sm text-stone-600">Our chatbots understand local business needs and speak Arabic and English fluently</p>
                        </div>
                        <!-- Card 2: Human Touch Setup -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/user-cog.svg" alt="Human touch icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Human Touch Setup</h3>
                            <p class="text-sm text-stone-600">We personally train every chatbot based on your info – no templates</p>
                        </div>
                        <!-- Card 3: Mobile-Friendly + Easy to Use -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/mobile.svg" alt="Mobile device icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Mobile-Friendly + Easy to Use</h3>
                            <p class="text-sm text-stone-600">Works great on websites and phones, no app needed</p>
                        </div>
                        <!-- Card 4: Performance Tracking & Updates -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/chart.svg" alt="Performance chart icon" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">Performance Tracking & Updates</h3>
                            <p class="text-sm text-stone-600">We monitor performance and update your chatbot regularly to keep it effective</p>
                        </div>
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">لماذا تشات عمان؟</h2>
                        <p class="mt-2 text-md text-stone-600">ما الذي يجعل خدمتنا مميزة وموثوقة من قبل الشركات المحلية؟</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 max-w-6xl mx-auto">
                        <!-- Card 1: Locally Trained AI -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/oman-pin.svg" alt="أيقونة موقع عُمان" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">ذكاء اصطناعي مدرّب محليًا</h3>
                            <p class="text-sm text-stone-600">روبوتاتنا مدرّبة لفهم احتياجات السوق المحلي، وتتحدث العربية والإنجليزية بطلاقة</p>
                        </div>
                        <!-- Card 2: Human Touch Setup -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/user-cog.svg" alt="أيقونة اللمسة البشرية" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">إعداد باللمسة البشرية</h3>
                            <p class="text-sm text-stone-600">نقوم بتدريب كل روبوت يدويًا باستخدام معلومات عملك – بدون قوالب جاهزة</p>
                        </div>
                        <!-- Card 3: Mobile-Friendly + Easy to Use -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/mobile.svg" alt="أيقونة الجهاز المحمول" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">متوافق مع الجوال + سهل الاستخدام</h3>
                            <p class="text-sm text-stone-600">يعمل بسلاسة على المواقع والهواتف، بدون الحاجة لتطبيق</p>
                        </div>
                        <!-- Card 4: Performance Tracking & Updates -->
                        <div class="why-chatoman-card bg-white p-6 rounded-2xl shadow-md flex flex-col items-center text-center">
                            <div class="w-16 h-16 mb-4">
                                <img src="./assets/icons/chart.svg" alt="أيقونة مخطط الأداء" class="w-full h-full">
                            </div>
                            <h3 class="font-semibold text-lg mb-2">تتبع الأداء والتحديثات</h3>
                            <p class="text-sm text-stone-600">نراقب أداء الروبوت ونقوم بتحديثه باستمرار ليبقى فعّالًا وحديثًا</p>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Why ChatOman Section End -->

            <section id="calculator" class="mb-20">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">Find Your Perfect Plan</h2>
                        <p class="mt-2 text-md text-stone-600">Start by selecting a base plan, then add any extras you need. Your total updates instantly</p>
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">اختر خطتك المثالية</h2>
                        <p class="mt-2 text-md text-stone-600">ابدأ باختيار الخطة الأساسية، ثم أضف أي إضافات تحتاجها. سيتحدث الإجمالي فورًا</p>
                    </div>
                </div>

                <!-- Monthly/Yearly Toggle - English -->
                <div class="lang-en">
                    <div class="toggle-switch">
                        <div id="toggle-slider-en" class="slider"></div>
                        <button id="bill-monthly-en" class="active">Monthly</button>
                        <button id="bill-yearly-en">Yearly</button>
                    </div>
                </div>

                <!-- Monthly/Yearly Toggle - Arabic -->
                <div class="lang-ar">
                    <div class="toggle-switch">
                        <div id="toggle-slider-ar" class="slider"></div>
                        <button id="bill-monthly-ar" class="active">شهريًا</button>
                        <button id="bill-yearly-ar">سنويًا</button>
                    </div>
                </div>

                <!-- Pricing Plans Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                    <!-- English Pricing Cards -->
                    <div class="lang-en col-span-full">
                        <div class="pricing-wrapper-en grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- English plan cards will be dynamically inserted here -->
                        </div>
                    </div>

                    <!-- Arabic Pricing Cards -->
                    <div class="lang-ar col-span-full">
                        <div class="pricing-wrapper-ar grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Arabic plan cards will be dynamically inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Add-ons Section -->
                <div class="bg-white p-8 rounded-2xl shadow-lg max-w-4xl mx-auto">
                    <!-- English Version -->
                    <div class="lang-en">
                        <h3 class="text-2xl font-bold text-center border-b pb-4 mb-6">Add-ons</h3>
                        <!-- New text link for feature explanations -->
                        <p class="text-sm text-center mb-6">
                            <a href="#features" class="text-teal-700 hover:underline text-sm" style="color: #008080;">
                                Need more details? View full feature explanations
                            </a>
                        </p>
                    </div>

                    <!-- Arabic Version -->
                    <div class="lang-ar">
                        <h3 class="text-2xl font-bold text-center border-b pb-4 mb-6">الإضافات</h3>
                        <!-- New text link for feature explanations -->
                        <p class="text-sm text-center mb-6">
                            <a href="#features" class="text-teal-700 hover:underline text-sm" style="color: #008080;">
                                هل تحتاج إلى مزيد من التفاصيل؟ شاهد شرح الميزات الكامل
                            </a>
                        </p>
                    </div>

                    <div id="addons-selection" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                    </div>

                    <div class="bg-teal-50 border border-teal-200 p-6 rounded-xl">
                        <!-- English Version -->
                        <div class="lang-en">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-stone-600">One-time Setup Fee:</span>
                                <span id="setup-fee-display" class="font-bold text-lg">0 OMR</span>
                            </div>
                            <div class="flex justify-between items-center text-2xl font-bold mb-4">
                                <span id="total-label-en" class="text-teal-800">Monthly Total:</span>
                                <span id="total-price-display" class="text-teal-600">0 OMR</span>
                            </div>
                            <button id="get-started-btn-static" class="w-full bg-teal-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors">
                                Get Started
                            </button>
                        </div>

                        <!-- Arabic Version -->
                        <div class="lang-ar">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-stone-600">رسوم الإعداد لمرة واحدة:</span>
                                <span id="setup-fee-display-ar" class="font-bold text-lg">٠ ريال عماني</span>
                            </div>
                            <div class="flex justify-between items-center text-2xl font-bold mb-4">
                                <span id="total-label-ar" class="text-teal-800">الإجمالي الشهري:</span>
                                <span id="total-price-display-ar" class="text-teal-600">٠ ريال عماني</span>
                            </div>
                            <button id="get-started-btn-static-ar" class="w-full bg-teal-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors">
                                ابدأ الآن
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Removed the "Visual Comparison" section -->

            <section id="features" class="mb-20">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">Understanding The Features</h2>
                        <p class="mt-2 text-md text-stone-600">Here's what our key features mean for your business</p>
                    </div>
                    <div id="accordion-container-en" class="max-w-3xl mx-auto space-y-4">
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">فهم الميزات</h2>
                        <p class="mt-2 text-md text-stone-600">إليك ما تعنيه ميزاتنا الرئيسية لعملك</p>
                    </div>
                    <div id="accordion-container-ar" class="max-w-3xl mx-auto space-y-4">
                    </div>
                </div>
            </section>

            <!-- LLM-powered FAQ Generator -->
            <section id="faq-generator" class="mb-20">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">Generate ✨ Suggested FAQs to Train Your Chatbot</h2>
                        <p class="mt-2 text-md text-stone-600">Not sure what your bot should say? Enter your business type below, and our built-in AI will suggest example FAQs you can include in your sign-up form. We'll use these to train your custom chatbot for your business</p>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg max-w-xl mx-auto">
                        <div class="mb-4">
                            <label for="business-type-input" class="block text-stone-700 text-sm font-bold mb-2">Your Business Type (e.g., "Cafe", "Clinic", "Retail Shop"):</label>
                            <input type="text" id="business-type-input" placeholder="e.g., Restaurant" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-stone-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500 transition-colors">
                        </div>
                        <button id="generate-faq-btn" class="w-full bg-teal-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors flex items-center justify-center">
                            Generate ✨ Suggested FAQs
                        </button>
                        <div id="faq-loading-indicator" class="mt-4 text-center text-teal-600 hidden">
                            Generating FAQs...
                        </div>
                        <div id="generated-faqs" class="mt-6 p-4 bg-stone-50 rounded-lg border border-stone-200 min-h-[100px] text-stone-700 whitespace-pre-wrap">
                            Your generated FAQs will appear here
                        </div>
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">أنشئ أسئلة شائعة مقترحة لتدريب روبوت الدردشة الخاص بك ✨</h2>
                        <p class="mt-2 text-md text-stone-600">لست متأكدًا مما يجب أن يقوله روبوتك؟ أدخل نوع عملك أدناه، وسيقترح الذكاء الاصطناعي المدمج لدينا أمثلة للأسئلة الشائعة التي يمكنك تضمينها في نموذج التسجيل الخاص بك. سنستخدم هذه لتدريب روبوت الدردشة المخصص لعملك</p>
                    </div>
                    <div class="bg-white p-6 rounded-2xl shadow-lg max-w-xl mx-auto">
                        <div class="mb-4">
                            <label for="business-type-input-ar" class="block text-stone-700 text-sm font-bold mb-2">نوع عملك (على سبيل المثال، "مقهى"، "عيادة"، "متجر بيع بالتجزئة"):</label>
                            <input type="text" id="business-type-input-ar" placeholder="مثال: مطعم" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-stone-700 leading-tight focus:outline-none focus:shadow-outline focus:border-teal-500 transition-colors">
                        </div>
                        <button id="generate-faq-btn-ar" class="w-full bg-teal-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-teal-700 transition-colors flex items-center justify-center">
                            أنشئ أسئلة شائعة مقترحة ✨
                        </button>
                        <div id="faq-loading-indicator-ar" class="mt-4 text-center text-teal-600 hidden">
                            جاري إنشاء الأسئلة الشائعة...
                        </div>
                        <div id="generated-faqs-ar" class="mt-6 p-4 bg-stone-50 rounded-lg border border-stone-200 min-h-[100px] text-stone-700 whitespace-pre-wrap">
                            ستظهر الأسئلة الشائعة التي تم إنشاؤها هنا
                        </div>
                    </div>
                </div>
            </section>
            <!-- End LLM-powered FAQ Generator -->

            <section id="suitability" class="text-center">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">Who Is This For?</h2>
                        <p class="mt-2 text-md text-stone-600">We've designed our plans to match the needs of local businesses</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">Starter</h3>
                            <p class="text-stone-600 mt-2">Perfect for small Instagram shops and startups who need a simple, automated way to answer common questions</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">Pro</h3>
                            <p class="text-stone-600 mt-2">Ideal for physical stores like cafes, clinics, and mid-sized retail that handle frequent inquiries about appointments, menus, or services</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">Elite</h3>
                            <p class="text-stone-600 mt-2">The ultimate solution for hotels, medical facilities, and multi-location brands that require professional, branded, high-volume support</p>
                        </div>
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="text-center mb-12">
                        <h2 class="text-3xl font-bold">لمن هذه الخدمة؟</h2>
                        <p class="mt-2 text-md text-stone-600">لقد صممنا خططنا لتناسب احتياجات الشركات المحلية</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">المبتدئ</h3>
                            <p class="text-stone-600 mt-2">مثالي للمتاجر الصغيرة على انستغرام والشركات الناشئة التي تحتاج إلى طريقة بسيطة ومؤتمتة للإجابة على الأسئلة الشائعة</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">المحترف</h3>
                            <p class="text-stone-600 mt-2">مثالي للمتاجر الفعلية مثل المقاهي والعيادات ومتاجر التجزئة متوسطة الحجم التي تتعامل مع الاستفسارات المتكررة حول المواعيد أو القوائم أو الخدمات</p>
                        </div>
                        <div class="bg-white p-6 rounded-2xl shadow-md">
                            <h3 class="font-bold text-teal-700 text-lg">النخبة</h3>
                            <p class="text-stone-600 mt-2">الحل الأمثل للفنادق والمرافق الطبية والعلامات التجارية متعددة المواقع التي تتطلب دعمًا احترافيًا ومخصصًا وذا حجم كبير</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Contact Us Section -->
            <section id="contact-us" class="text-center mt-20 mb-12">
                <!-- English Version -->
                <div class="lang-en">
                    <div class="bg-white p-6 rounded-2xl shadow-lg max-w-xl mx-auto">
                        <h2 class="text-3xl font-bold text-teal-700 mb-4">Contact Us</h2>
                        <p class="text-lg text-stone-600 mb-2">
                            Instagram: <a href="https://www.instagram.com/chatoman.co?igsh=MWd5Z3g5NDNmYjBlbQ%3D%3D&utm_source=qr" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline">@chatoman.co</a>
                        </p>
                        <p class="text-lg text-stone-600">
                            Email: <a href="mailto:info@chatoman.co" class="text-teal-600 hover:underline">info@chatoman.co</a>
                        </p>
                    </div>
                </div>

                <!-- Arabic Version -->
                <div class="lang-ar">
                    <div class="bg-white p-6 rounded-2xl shadow-lg max-w-xl mx-auto">
                        <h2 class="text-3xl font-bold text-teal-700 mb-4">اتصل بنا</h2>
                        <p class="text-lg text-stone-600 mb-2">
                            انستغرام: <a href="https://www.instagram.com/chatoman.co?igsh=MWd5Z3g5NDNmYjBlbQ%3D%3D&utm_source=qr" target="_blank" rel="noopener noreferrer" class="text-teal-600 hover:underline">تشات_عمان@</a>
                        </p>
                        <p class="text-lg text-stone-600">
                            البريد الإلكتروني: <a href="mailto:info@chatoman.co" class="text-teal-600 hover:underline">راسلنا</a>
                        </p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-20 border-t pt-8">
            <!-- English Version -->
            <div class="lang-en">
                <p class="text-stone-600">&copy; 2025 ChatOman. All rights reserved</p>
                <p class="text-sm text-stone-500 mt-2">
                    <a href="https://drive.google.com/file/d/1SAvfegTPfldVI6_paFjiljJFgmBLA3lv/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-stone-500 hover:underline px-2">Terms of Service</a> | 
                    <a href="https://drive.google.com/file/d/1SIblYVGlIoIclA454ZtvmXwR4esFlllV/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-stone-500 hover:underline px-2">Privacy Policy</a>
                </p>
                <p class="text-sm text-stone-500 mt-2">Bilingual AI Chatbots for Omani Businesses</p>
            </div>

            <!-- Arabic Version -->
            <div class="lang-ar">
                <p class="text-stone-600">&copy; ٢٠٢٥ تشات عُمان. جميع الحقوق محفوظة</p>
                <p class="text-sm text-stone-500 mt-2">
                    <a href="https://drive.google.com/file/d/1SAvfegTPfldVI6_paFjiljJFgmBLA3lv/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-stone-500 hover:underline px-2">شروط الخدمة</a> | 
                    <a href="https://drive.google.com/file/d/1SIblYVGlIoIclA454ZtvmXwR4esFlllV/view?usp=sharing" target="_blank" rel="noopener noreferrer" class="text-stone-500 hover:underline px-2">سياسة الخصوصية</a>
                </p>
                <p class="text-sm text-stone-500 mt-2">روبوتات دردشة ذكية ثنائية اللغة للشركات العُمانية</p>
            </div>
        </footer>

    </div>

    <!-- Modal for Feature Explanations -->
    <div id="feature-modal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-button" id="modal-close-button">&times;</button>
            <h3 id="modal-title" class="text-xl font-bold mb-4"></h3>
            <p id="modal-content" class="text-stone-700"></p>
        </div>
    </div>

    <!-- Feature Popup Modal -->
    <div id="feature-popup-modal" class="modal-overlay">
        <div class="modal-content max-w-md">
            <button class="modal-close-button" id="feature-popup-close-button">&times;</button>
            <h3 id="feature-popup-title" class="text-lg font-bold mb-3"></h3>
            <p id="feature-popup-content" class="text-stone-600 text-sm"></p>
        </div>
    </div>

    <!-- Language Toggle Button -->
    <div id="language-toggle" class="fixed top-4 right-4 md:top-4 md:right-4 bottom-4 left-4 md:bottom-auto md:left-auto z-50">
        <button id="lang-button" class="w-12 h-12 bg-white border-2 border-teal-600 rounded-full shadow-lg flex items-center justify-center text-teal-600 font-bold text-sm hover:bg-teal-50 transition-colors">
            EN ▾
        </button>
        <div id="lang-dropdown" class="absolute top-14 right-0 md:top-14 md:right-0 bottom-14 left-0 md:bottom-auto md:left-auto bg-white border border-stone-200 rounded-lg shadow-lg min-w-[120px] hidden">
            <div class="py-1">
                <button class="lang-option w-full text-left px-3 py-2 text-sm hover:bg-stone-50 transition-colors" data-lang="en">
                    <span class="lang-en">EN | English</span>
                    <span class="lang-ar">EN | English</span>
                </button>
                <button class="lang-option w-full text-left px-3 py-2 text-sm hover:bg-stone-50 transition-colors" data-lang="ar">
                    <span class="lang-en">AR | العربية</span>
                    <span class="lang-ar">AR | العربية</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Sticky Get Started Button -->
    <div id="sticky-get-started" class="fixed bottom-4 z-40 rounded-lg shadow-lg bg-teal-600 hover:bg-teal-700 transition-colors p-3 text-white font-bold text-center sticky-get-started">
        <!-- English Version -->
        <div class="lang-en">
            <button class="w-full h-full">Get Started</button>
        </div>
        <!-- Arabic Version -->
        <div class="lang-ar">
            <button class="w-full h-full">ابدأ الآن</button>
        </div>
    </div>

    <script>
        // Google Form URL - moved to global scope
        const googleFormURL = "https://docs.google.com/forms/d/e/1FAIpQLSdH72A9D2bouVJwVk09PEQrVM4B15pW4kcoN3gB6scBCEQ6LA/viewform?usp=header";

        // Language audit checker
        function auditLanguageSeparation() {
            const arabicRegex = /[\u0600-\u06FF]/;
            const englishRegex = /[a-zA-Z]/;
            const issues = [];

            function getElementPath(element) {
                const path = [];
                while (element && element !== document) {
                    let selector = element.tagName.toLowerCase();
                    if (element.id) selector += `#${element.id}`;
                    if (element.className) selector += `.${element.className.split(' ').join('.')}`;
                    path.unshift(selector);
                    element = element.parentElement;
                }
                return path.join(' > ');
            }

            // Check all .lang-en elements
            document.querySelectorAll('.lang-en *').forEach(el => {
                const text = el.textContent.trim();
                if (text && arabicRegex.test(text)) {
                    issues.push({
                        type: 'Arabic in English block',
                        path: getElementPath(el),
                        text: text.substring(0, 100)
                    });
                }
            });

            // Check all .lang-ar elements
            document.querySelectorAll('.lang-ar *').forEach(el => {
                const text = el.textContent.trim();
                if (text && englishRegex.test(text) && !text.match(/^[0-9\s\u0600-\u06FF]+$/)) {
                    issues.push({
                        type: 'English in Arabic block',
                        path: getElementPath(el),
                        text: text.substring(0, 100)
                    });
                }
            });

            if (issues.length > 0) {
                console.warn('Language separation issues found:');
                issues.forEach(issue => console.warn(issue));
            } else {
                console.log('✅ No language separation issues found!');
            }

            return issues;
        }

        // Pricing data
        const pricingData = [
            { 
                id: 'starter', 
                name: { en: 'Starter', ar: 'المبتدئ' },
                price: { monthly: 25, yearly: 275 },
                credits: 1000, 
                agents: 1, 
                setupFee: { monthly: 0, yearly: 0 },
                features: {
                    brandingRemoved: false,
                    customDomain: false,
                    basicFaqSupport: true,
                    responseUpdates: '2x/month',
                    chatUpdatesWeekly: false,
                    lightCustomization: false,
                    fullPersonalization: false,
                    dedicatedChatbotManager: false
                },
                bestFor: { 
                    en: 'Perfect for small Instagram shops and startups', 
                    ar: 'للمتاجر الصغيرة على انستغرام، الشركات الناشئة' 
                },
                yearlySavings: 25
            },
            { 
                id: 'pro', 
                name: { en: 'Pro', ar: 'المحترف' },
                price: { monthly: 45, yearly: 495 },
                credits: 2000, 
                agents: 1, 
                setupFee: { monthly: 15, yearly: 0 },
                features: {
                    brandingRemoved: false,
                    customDomain: false,
                    basicFaqSupport: true,
                    responseUpdates: '2x/month',
                    chatUpdatesWeekly: true,
                    lightCustomization: true,
                    fullPersonalization: false,
                    dedicatedChatbotManager: false
                },
                bestFor: { 
                    en: 'Ideal for cafes, clinics, and mid-sized retail', 
                    ar: 'للمقاهي، العيادات، متاجر التجزئة متوسطة الحجم' 
                },
                yearlySavings: 45
            },
            { 
                id: 'elite', 
                name: { en: 'Elite', ar: 'النخبة' },
                price: { monthly: 90, yearly: 1000 },
                credits: 3000, 
                agents: 2, 
                setupFee: { monthly: 25, yearly: 0 },
                features: {
                    brandingRemoved: true,
                    customDomain: true,
                    basicFaqSupport: true,
                    responseUpdates: '2x/month',
                    chatUpdatesWeekly: true,
                    lightCustomization: true,
                    fullPersonalization: true,
                    dedicatedChatbotManager: false
                },
                bestFor: { 
                    en: 'Perfect for hotels, medical facilities, and multi-location brands', 
                    ar: 'للفنادق، المرافق الطبية، العلامات التجارية متعددة المواقع' 
                },
                yearlySavings: 80
            }
        ];

        // State variables for pricing
        let selectedPlanId = null;
        let selectedAddOnIds = new Set();
        let currentBillingCycle = { en: 'monthly', ar: 'monthly' };

        // Arabic digits conversion
        const arabicDigits = n => n.toString().replace(/[0-9]/g, d => "٠١٢٣٤٥٦٧٨٩"[d]);

        // Helper function to get price with proper formatting
        function getPrice(plan, cycle, lang) {
            const val = cycle === 'monthly' ? plan.price.monthly : plan.price.yearly;
            return lang === 'ar' ? arabicDigits(val) : val;
        }

        // Helper function to get setup fee with proper formatting
        function getSetupFee(plan, cycle, lang) {
            const val = cycle === 'monthly' ? plan.setupFee.monthly : plan.setupFee.yearly;
            if (val === 0) {
                return lang === 'ar' ? 'مجاني' : 'Free';
            }
            return lang === 'ar' ? `${arabicDigits(val)} ريال عماني` : `${val} OMR`;
        }

        // Create pricing card
        function createCard(plan, lang, cycle) {
            const price = getPrice(plan, cycle, lang);
            const setupFee = getSetupFee(plan, cycle, lang);
            const period = cycle === 'monthly' ? 
                (lang === 'ar' ? 'شهريًا' : 'mo') : 
                (lang === 'ar' ? 'سنويًا' : 'year');
            const currency = lang === 'ar' ? 'ريال عماني' : 'OMR';
            const isProPlan = plan.id === 'pro';

            const card = document.createElement('div');
            card.className = `plan-card bg-white p-6 rounded-2xl shadow-md border-2 border-transparent cursor-pointer relative ${isProPlan ? 'pt-10' : ''}`;
            card.dataset.planId = plan.id;

            if (lang === 'ar') {
                card.style.direction = 'rtl';
                card.style.textAlign = 'right';
            }

            const credits = lang === 'ar' ? arabicDigits(plan.credits.toLocaleString()) : plan.credits.toLocaleString();
            const agents = lang === 'ar' ? arabicDigits(plan.agents) : plan.agents;

            card.innerHTML = `
                ${isProPlan ? `<div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-teal-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg z-10">${lang === 'ar' ? 'الأكثر شيوعًا' : 'Most Popular'}</div>` : ''}
                <h3 class="text-xl font-bold text-teal-700 ${lang === 'ar' ? 'text-right' : ''}">${plan.name[lang]}</h3>
                <div class="text-sm text-stone-600 mb-4 ${lang === 'ar' ? 'text-right' : ''}">${plan.bestFor[lang]}</div>
                <div class="text-3xl font-bold my-4 ${lang === 'ar' ? 'text-right' : ''}">
                    ${price} 
                    <span class="text-lg font-normal text-stone-500">${currency}/${period}</span>
                </div>
                ${cycle === 'yearly' ? `<div class="text-sm text-stone-600 mb-4 ${lang === 'ar' ? 'text-right' : ''}">${lang === 'ar' ? `وفر ${arabicDigits(plan.yearlySavings)} ريال عماني/سنويًا` : `Save ${plan.yearlySavings} OMR/year`}</div>` : ''}
                <div class="space-y-2 text-stone-600 mb-4" style="${lang === 'ar' ? 'direction: rtl; text-align: right;' : ''}">
                    <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="messages">
                        ${lang === 'ar' ? 
                            `<span>${credits} رسالة/شهريًا</span> <span class="text-teal-500 mr-2">✔</span>` :
                            `<span class="text-teal-500 mr-2">✔</span> <span>${credits} credits/mo</span>`
                        }
                    </div>
                    <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="agents">
                        ${lang === 'ar' ? 
                            `<span>${agents} وكيل ذكاء اصطناعي</span> <span class="text-teal-500 mr-2">✔</span>` :
                            `<span class="text-teal-500 mr-2">✔</span> <span>${agents} AI Agent(s)</span>`
                        }
                    </div>
                    ${plan.id === 'starter' ? `
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="basic-faq">
                            ${lang === 'ar' ? '<span>دعم أساسي للأسئلة الشائعة</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Basic FAQ Support</span>'}
                        </div>
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="response-updates">
                            ${lang === 'ar' ? '<span>تحديثات الردود مرتين شهريًا</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Response Updates 2x/month</span>'}
                        </div>
                    ` : ''}
                    ${plan.id === 'pro' ? `
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="chat-updates">
                            ${lang === 'ar' ? '<span>تحديثات الدردشة أسبوعيًا</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Chat Updates Weekly</span>'}
                        </div>
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="light-customization">
                            ${lang === 'ar' ? '<span>تخصيص خفيف، أسئلة شائعة + تدفق</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Light Customization, FAQ + Flow</span>'}
                        </div>
                    ` : ''}
                    ${plan.id === 'elite' ? `
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="dedicated-manager">
                            ${lang === 'ar' ? '<span>مدير روبوت مخصص</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Dedicated Chatbot Manager</span>'}
                        </div>
                        <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="full-personalization">
                            ${lang === 'ar' ? '<span>تخصيص كامل</span> <span class="text-teal-500 mr-2">✔</span>' : '<span class="text-teal-500 mr-2">✔</span> <span>Full Personalization</span>'}
                        </div>
                    ` : ''}
                    <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="branding-removed">
                        ${lang === 'ar' ? 
                            `<span>إزالة العلامة التجارية</span> <span class="${plan.features.brandingRemoved ? 'text-teal-500' : 'text-stone-400'} mr-2">${plan.features.brandingRemoved ? '✔' : '✖'}</span>` :
                            `<span class="${plan.features.brandingRemoved ? 'text-teal-500' : 'text-stone-400'} mr-2">${plan.features.brandingRemoved ? '✔' : '✖'}</span> <span>Branding Removed</span>`
                        }
                    </div>
                    <div class="flex items-center ${lang === 'ar' ? 'justify-end' : ''} cursor-pointer hover:bg-stone-50 p-1 rounded feature-item" data-feature="custom-domain">
                        ${lang === 'ar' ? 
                            `<span>نطاق مخصص</span> <span class="${plan.features.customDomain ? 'text-teal-500' : 'text-stone-400'} mr-2">${plan.features.customDomain ? '✔' : '✖'}</span>` :
                            `<span class="${plan.features.customDomain ? 'text-teal-500' : 'text-stone-400'} mr-2">${plan.features.customDomain ? '✔' : '✖'}</span> <span>Custom Domain</span>`
                        }
                    </div>
                    <div class="text-sm text-stone-600 mt-2 ${lang === 'ar' ? 'text-right' : ''}">
                        ${lang === 'ar' ? 'رسوم الإعداد:' : 'Setup Fee:'} ${setupFee}
                    </div>
                </div>
                <button class="plan-cta w-full bg-teal-600 text-white font-bold py-3 px-4 rounded-lg mt-6 hover:bg-teal-700 transition-colors">
                    ${lang === 'ar' ? 'ابدأ الآن' : 'Start Now'}
                </button>
            `;

            return card;
        }

        // Main render function
        function renderPricing(lang, cycle) {
            const wrapper = document.querySelector(
                lang === 'ar' ? '.pricing-wrapper-ar' : '.pricing-wrapper-en'
            );
            if (!wrapper) return;

            wrapper.innerHTML = ''; // Clear existing cards

            pricingData.forEach(plan => {
                const card = createCard(plan, lang, cycle);
                wrapper.appendChild(card);
            });

            // Add event listeners to new cards
            wrapper.querySelectorAll('.plan-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    // Don't select plan if clicking on CTA button, feature link, or feature item
                    if (e.target.classList.contains('plan-cta') || 
                        e.target.classList.contains('feature-link') || 
                        e.target.closest('.feature-item')) {
                        return;
                    }
                    const planId = card.dataset.planId;
                    handlePlanSelection(planId);
                });
            });

            // Add event listeners for feature items in pricing cards
            wrapper.querySelectorAll('.feature-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const featureKey = item.dataset.feature;
                    openFeaturePopup(featureKey);
                });
            });

            wrapper.querySelectorAll('.plan-cta').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.stopPropagation(); // Prevent plan selection when clicking CTA
                    if (googleFormURL) {
                        window.open(googleFormURL, '_blank');
                    }
                });
            });

            wrapper.querySelectorAll('.feature-link').forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    event.stopPropagation(); // Prevent plan selection when clicking feature link
                    const featureTitle = event.target.dataset.featureTitle;
                    const explanation = featureExplanations.find(f => f.title === featureTitle);
                    if (explanation) {
                        openModal(explanation.title, explanation.content + '<br><br><span class="font-tajawal">' + explanation.arabicContent + '</span>');
                    }
                });
            });
        }

        // Setup billing toggle for a specific language
        function setupBillingToggle(lang) {
            const btnMonthly = document.getElementById(`bill-monthly-${lang}`);
            const btnYearly = document.getElementById(`bill-yearly-${lang}`);
            const slider = document.getElementById(`toggle-slider-${lang}`);

            if (!btnMonthly || !btnYearly || !slider) return;

            // Correct mapping for Arabic
            const cycleMap = lang === 'ar' 
                ? { 'شهريًا': 'monthly', 'سنويًا': 'yearly' }
                : { 'Monthly': 'monthly', 'Yearly': 'yearly' };

            [btnMonthly, btnYearly].forEach(btn => {
                btn.onclick = () => {
                    const cycle = cycleMap[btn.textContent.trim()];
                    currentBillingCycle[lang] = cycle;
                    renderPricing(lang, cycle);

                    // Update button states
                    btnMonthly.classList.toggle('active', cycle === 'monthly');
                    btnYearly.classList.toggle('active', cycle === 'yearly');

                    // Update slider position
                    if (cycle === 'yearly') {
                        slider.classList.add('yearly');
                    } else {
                        slider.classList.remove('yearly');
                    }

                    // Update pricing display
                    updateDisplay();
                };
            });
        }

        const addOns = [
            { id: 'extraCredits', name: 'Extra 1,000 Messages', priceOMR: 8, arabicName: 'ألف رسالة إضافية', featureExplanationTitle: 'Message Credits' },
            { id: 'brandingRemoval', name: 'Branding Removal', priceOMR: 25, arabicName: 'إزالة العلامة التجارية', featureExplanationTitle: 'Branding Removed' },
            { id: 'customDomain', name: 'Custom Domain', priceOMR: 35, arabicName: 'نطاق مخصص', featureExplanationTitle: 'Custom Domain' },
            { id: 'whatsappIntegration', name: 'WhatsApp Integration', priceOMR: 25, arabicName: 'تكامل مع واتساب', featureExplanationTitle: 'WhatsApp Integration' },
            { id: 'performanceReport', name: 'Performance Report', priceOMR: 10, arabicName: 'تقرير الأداء الشهري', featureExplanationTitle: 'Performance Report' },
            { id: 'extraAIAgent', name: 'Extra AI Agent', priceOMR: 9, arabicName: 'وكيل ذكاء اصطناعي إضافي', featureExplanationTitle: 'AI Agents' },
            // New bundle add-ons
            { id: 'proInsightsPack', name: 'Pro Insights Pack', priceOMR: 30, arabicName: 'حزمة رؤى المحترفين', featureExplanationTitle: 'Pro Insights Pack' },
            { id: 'eliteBrandScaleKit', name: 'Elite Brand & Scale Kit', priceOMR: 55, arabicName: 'حزمة النخبة للعلامة التجارية والتوسع', featureExplanationTitle: 'Elite Brand & Scale Kit' }
        ];

        // English feature explanations
        const featureExplanationsEN = [
            { title: 'Message Credits', content: 'Each time the AI chatbot sends a reply to a user, it consumes one message credit. Our plans come with a monthly allowance, and you can add more if needed. Unused credits do not roll over.' },
            { title: 'AI Agents', content: 'An AI Agent is like a distinct chatbot with its own unique knowledge base and personality. You might use one agent for customer support and a separate one for sales inquiries, each trained on different information.' },
            { title: 'Branding Removed', content: 'This removes both the Powered by Chatbase label and any ChatOman branding (e.g., footer logo or name) from your chatbot.' },
            { title: 'Custom Domain', content: 'Instead of a generic link, your chatbot can live on a subdomain of your website (e.g., bot.yourbusiness.com). This enhances professionalism and trust with your customers.' },
            { title: 'Basic FAQ Support', content: 'This includes initial setup of fundamental FAQs based on your provided information, ensuring your chatbot can answer common customer questions right away.' },
            { title: 'Response Updates 2x/month', content: 'We\'ll review and update your chatbot\'s responses twice a month to ensure accuracy and relevance, keeping your bot\'s information fresh.' },
            { title: 'Chat Updates Weekly', content: 'For businesses with more dynamic needs, we provide weekly reviews and updates to your chatbot\'s chat flows and responses, ensuring it stays current with your offerings.' },
            { title: 'Light Customization, FAQ + Flow', content: 'Beyond basic FAQs, this includes light customization of your chatbot\'s personality and basic conversational flows to guide users through common interactions.' },
            { title: 'Full Personalization', content: 'Our Elite plan offers comprehensive personalization, which includes deep customization of your chatbot\'s persona, advanced conversational flows, regular performance reviews, and dedicated updates to ensure it perfectly aligns with your business goals.' },
            { title: 'WhatsApp Integration', content: 'Seamlessly integrate your AI chatbot with WhatsApp, allowing your customers to interact with your bot directly on the platform they use most. Note: Third-party WhatsApp API costs may apply.' },
            { title: 'Performance Report', content: 'Receive a monthly report detailing your chatbot\'s performance, including message volume, common queries, and user satisfaction, helping you understand its impact and identify areas for improvement.' },
            { title: 'Dedicated Chatbot Manager', content: 'A dedicated manager will oversee your chatbot\'s performance, provide tailored recommendations, and ensure it consistently meets your business objectives.' },
            { title: 'Pro Insights Pack', content: 'This bundle includes a Performance Report and Branding Removal, offering enhanced insights and a white-label experience. You save 5 OMR/month compared to purchasing these separately.' },
            { title: 'Elite Brand & Scale Kit', content: 'This comprehensive bundle provides an additional 1,000 messages, Branding Removal, and a Custom Domain, designed for businesses looking to scale and fully brand their chatbot. You save 13 OMR/month compared to purchasing these separately.' },
            {
                title: 'FAQs',
                content: `
                    <ul>
                        <li><strong>Q:</strong> What is ChatOman?<br><strong>A:</strong> ChatOman builds custom, bilingual AI chatbots for Omani businesses to answer customer questions 24/7 in Arabic and English.</li>
                        <li><strong>Q:</strong> How does the chatbot work?<br><strong>A:</strong> We train the bot on your FAQs, menus, and service info. When customers type a question, the bot searches that knowledge and replies instantly.</li>
                        <li><strong>Q:</strong> Is the chatbot really bilingual?<br><strong>A:</strong> Yes. Every bot is set up to understand and reply in Arabic (including Omani dialect) and English.</li>
                        <li><strong>Q:</strong> How much does it cost?<br><strong>A:</strong> Plans start at 25 OMR/month (Starter), 45 OMR/month (Pro), and 90 OMR/month (Elite). Yearly billing saves up to 80 OMR.</li>
                        <li><strong>Q:</strong> What is a message credit?<br><strong>A:</strong> One credit = one reply sent by the chatbot. If you receive 1,000 customer questions, that uses 1,000 credits.</li>
                        <li><strong>Q:</strong> Can I upgrade later?<br><strong>A:</strong> Absolutely. You can switch plans or add credits/agents anytime—just email us.</li>
                        <li><strong>Q:</strong> How long does setup take?<br><strong>A:</strong> Usually 2–3 business days after we receive your onboarding form.</li>
                        <li><strong>Q:</strong> Can I update answers later?<br><strong>A:</strong> Yes—send new FAQs or edits, and we'll retrain the bot (included in all plans).</li>
                        <li><strong>Q:</strong> Does it work on WhatsApp or Instagram?<br><strong>A:</strong> Yes. With our WhatsApp add-on or IG link, customers chat directly in their favorite app.</li>
                        <li><strong>Q:</strong> Can I remove "Powered by Chatbase"?<br><strong>A:</strong> Yes—the Branding Removal add-on hides third-party labels so the bot looks 100% yours.</li>
                        <li><strong>Q:</strong> What if I run out of credits?<br><strong>A:</strong> You'll get an email alert. Buy extra credits instantly from the Add-Ons section.</li>
                        <li><strong>Q:</strong> How do I contact support?<br><strong>A:</strong> Email us at info@chatoman.co — we reply within 24 hours.</li>
                    </ul>
                `
            }
        ];

        // Arabic feature explanations
        const featureExplanationsAR = [
            { title: 'أرصدة الرسائل', content: 'كل مرة يرد فيها روبوت الدردشة على المستخدم، يتم استخدام رصيد واحد. تأتي خططنا مع رصيد شهري، ويمكنك إضافة المزيد إذا لزم الأمر. الأرصدة غير المستخدمة لا ترحل للشهر التالي' },
            { title: 'الوكلاء الذكيين', content: 'الوكيل الذكي هو روبوت دردشة منفصل بقاعدة معرفة وشخصية فريدة خاصة به. يمكنك استخدام وكيل واحد لدعم العملاء وآخر منفصل لاستفسارات المبيعات، وكل منهما مدرب على معلومات مختلفة' },
            { title: 'إزالة العلامة التجارية', content: 'يزيل عبارة "مدعوم من شاتبَيس" وأي علامة تجارية لتشات عُمان مثل الشعار أو الاسم.' },
            { title: 'النطاق المخصص', content: 'بدلاً من الرابط العام، يمكن لروبوت الدردشة الخاص بك أن يتواجد على نطاق فرعي لموقعك الإلكتروني (مثال: bot.yourbusiness.com). هذا يعزز الاحترافية والثقة مع عملائك' },
            { title: 'دعم الأسئلة الشائعة الأساسية', content: 'يتضمن ذلك الإعداد الأولي للأسئلة الشائعة الأساسية بناءً على المعلومات التي تقدمها، مما يضمن أن روبوت الدردشة الخاص بك يمكنه الإجابة على أسئلة العملاء الشائعة فورًا' },
            { title: 'تحديثات الردود مرتين شهريًا', content: 'سنقوم بمراجعة وتحديث ردود روبوت الدردشة الخاص بك مرتين شهريًا لضمان الدقة والأهمية، مما يحافظ على تحديث معلومات الروبوت الخاص بك' },
            { title: 'تحديثات الدردشة أسبوعيًا', content: 'للشركات ذات الاحتياجات الأكثر ديناميكية، نقدم مراجعات وتحديثات أسبوعية لتدفقات الدردشة وردود روبوت الدردشة الخاص بك، مما يضمن بقاءه محدثًا مع عروضك' },
            { title: 'تخصيص خفيف، أسئلة شائعة + تدفق', content: 'بالإضافة إلى الأسئلة الشائعة الأساسية، يتضمن ذلك تخصيصًا خفيفًا لشخصية روبوت الدردشة الخاص بك وتدفقات محادثة أساسية لتوجيه المستخدمين خلال التفاعلات الشائعة' },
            { title: 'التخصيص الكامل', content: 'تقدم خطة النخبة لدينا تخصيصًا شاملاً، والذي يتضمن تخصيصًا عميقًا لشخصية روبوت الدردشة الخاص بك، وتدفقات محادثة متقدمة، ومراجعات أداء منتظمة، وتحديثات مخصصة لضمان توافقه التام مع أهداف عملك' },
            { title: 'تكامل واتساب', content: 'ادمج روبوت الدردشة الخاص بك بسلاسة مع واتساب، مما يسمح لعملائك بالتفاعل مع الروبوت مباشرة على المنصة التي يستخدمونها غالبًا. ملاحظة: قد تنطبق تكاليف واجهة برمجة تطبيقات واتساب على جهات خارجية' },
            { title: 'تقرير الأداء', content: 'احصل على تقرير شهري يوضح أداء روبوت الدردشة الخاص بك، بما في ذلك حجم الرسائل، والاستفسارات الشائعة، ورضا المستخدمين، مما يساعدك على فهم تأثيره وتحديد مجالات التحسين' },
            { title: 'مدير روبوت الدردشة المخصص', content: 'سيشرف مدير مخصص على أداء روبوت الدردشة الخاص بك، ويقدم توصيات مخصصة، ويضمن تلبيته المستمرة لأهداف عملك' },
            { title: 'حزمة رؤى المحترفين', content: 'تتضمن هذه الحزمة تقرير الأداء وإزالة العلامة التجارية، مما يوفر رؤى محسّنة وتجربة بيضاء. توفر ٥ ريال عماني/شهريًا مقارنةً بشرائها بشكل منفصل' },
            { title: 'حزمة النخبة للعلامة التجارية والتوسع', content: 'توفر هذه الحزمة الشاملة ١,٠٠٠ رسالة إضافية، وإزالة العلامة التجارية، ونطاقًا مخصصًا، وهي مصممة للشركات التي تتطلع إلى التوسع ووضع علامتها التجارية الكاملة على روبوت الدردشة الخاص بها. توفر ١٣ ريال عماني/شهريًا مقارنةً بشرائها بشكل منفصل' },
            {
                title: 'الأسئلة الشائعة',
                content: `
                    <ul>
                        <li><strong>س:</strong> ما هو تشات عُمان؟<br><strong>ج:</strong> تشات عُمان يقدّم روبوتات دردشة ذكية ثنائية اللغة مخصّصة للأعمال العُمانية للرد على استفسارات العملاء على مدار الساعة بالعربية والإنجليزية</li>
                        <li><strong>س:</strong> كيف يعمل روبوت الدردشة؟<br><strong>ج:</strong> نقوم بتدريب الروبوت على الأسئلة الشائعة والقوائم ومعلومات خدماتك. عند طرح العميل سؤالاً، يبحث الروبوت في هذه المعلومات ويجيب فوراً</li>
                        <li><strong>س:</strong> هل الروبوت ثنائي اللغة فعلاً؟<br><strong>ج:</strong> نعم، كل روبوت مهيأ ليفهم ويجيب بالعربية (يشمل اللهجة العُمانية) والإنجليزية</li>
                        <li><strong>س:</strong> كم سعر الخدمة؟<br><strong>ج:</strong> تبدأ الخطط من ٢٥ ريال/شهر (المبتدئ)، ٤٥ ريال/شهر (المحترف)، ٩٠ ريال/شهر (النخبة). الدفع السنوي يوفر حتى ٨٠ ريال</li>
                        <li><strong>س:</strong> ما هو رصيد الرسالة؟<br><strong>ج:</strong> رصيد واحد = رد واحد يرسله الروبوت. إذا استقبلت ١,٠٠٠ سؤال، فهذا يستهلك ١,٠٠٠ رصيد</li>
                        <li><strong>س:</strong> هل يمكنني الترقية لاحقاً؟<br><strong>ج:</strong> بالطبع. يمكنك تغيير الخطط أو إضافة أرصدة/وكلاء في أي وقت — فقط راسلنا</li>
                        <li><strong>س:</strong> كم يستغرق الإعداد؟<br><strong>ج:</strong> عادةً يومان إلى ثلاثة أيام عمل بعد استلام نموذج الانضمام</li>
                        <li><strong>س:</strong> هل يمكنني تعديل الإجابات لاحقاً؟<br><strong>ج:</strong> نعم — أرسل أسئلة جديدة أو تعديلات وسنعيد تدريب الروبوت (مشمول بكل الخطط)</li>
                        <li><strong>س:</strong> هل يعمل على واتساب أو إنستجرام؟<br><strong>ج:</strong> نعم. عبر إضافة واتساب أو رابط إنستجرام يمكن للعملاء المحادثة من تطبيقهم المفضل</li>
                        <li><strong>س:</strong> هل يمكن إزالة عبارة "Powered by Chatbase"؟<br><strong>ج:</strong> نعم — إضافة إزالة العلامة التجارية تخفي شعارات الطرف الثالث ليبدو الروبوت ملكك بالكامل</li>
                        <li><strong>س:</strong> ماذا لو انتهى رصيد الرسائل؟<br><strong>ج:</strong> يصلك تنبيه عبر البريد، ويمكنك شراء أرصدة إضافية فوراً من قسم الإضافات</li>
                        <li><strong>س:</strong> كيف أتواصل مع الدعم؟<br><strong>ج:</strong> راسلنا على info@chatoman.co — نرد خلال ٢٤ ساعة</li>
                    </ul>
                `
            }
        ];

        // Helper function to map addon IDs to feature keys
        function getAddonFeatureKey(addonId) {
            const mapping = {
                'extraCredits': 'extra-credits',
                'brandingRemoval': 'branding-removed',
                'customDomain': 'custom-domain',
                'whatsappIntegration': 'whatsapp-integration',
                'performanceReport': 'performance-report',
                'extraAIAgent': 'extra-agent',
                'proInsightsPack': 'pro-insights-pack',
                'eliteBrandScaleKit': 'elite-brand-scale'
            };
            return mapping[addonId] || addonId;
        }

        // Render add-ons function
        function renderAddOns() {
            const addonsSelectionContainer = document.getElementById('addons-selection');
            if (!addonsSelectionContainer) return;
            
            // Clear existing add-ons
            addonsSelectionContainer.innerHTML = '';
            
            const isArabicMode = currentLang === 'ar';
            
            if (isArabicMode) {
                // Arabic-specific add-ons with provided text
                const arabicAddOns = [
                    { id: 'extraCredits', name: '١,٠٠٠ رسالة إضافية', price: '٨' },
                    { id: 'brandingRemoval', name: 'إزالة العلامة التجارية', price: '٢٥' },
                    { id: 'customDomain', name: 'نطاق مخصص', price: '٣٥' },
                    { id: 'whatsappIntegration', name: 'دمج واتساب', price: '٢٥' },
                    { id: 'performanceReport', name: 'تقرير أداء', price: '١٠' },
                    { id: 'extraAIAgent', name: 'وكيل ذكاء اصطناعي إضافي', price: '٩' },
                    { id: 'proInsightsPack', name: 'حزمة رؤى احترافية', price: '٣٠' },
                    { id: 'eliteBrandScaleKit', name: 'حزمة النخبة للعلامة التجارية والتوسّع', price: '٥٥' }
                ];
                
                arabicAddOns.forEach(addOn => {
                    const addOnElement = document.createElement('label');
                    addOnElement.className = 'flex items-center bg-stone-100 p-4 rounded-lg cursor-pointer hover:bg-stone-200 transition-colors';
                    addOnElement.style.direction = 'rtl';
                    addOnElement.style.textAlign = 'right';
                    
                    addOnElement.innerHTML = `
                        <div class="flex-1 text-right">
                            <div class="flex items-center justify-start cursor-pointer feature-item" data-feature="${getAddonFeatureKey(addOn.id)}">
                                <span class="text-teal-500 ml-2">✔</span>
                                <span class="font-semibold text-stone-700">${addOn.name}</span>
                            </div>
                            <div class="text-sm text-stone-500 mt-1">
                                +${addOn.price} ريال/شهريًا
                            </div>
                        </div>
                        <input type="checkbox" data-addon-id="${addOn.id}" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500 border-stone-300 ml-4">
                    `;
                    
                    // Add event listener for checkbox
                    const checkbox = addOnElement.querySelector('input');
                    checkbox.addEventListener('change', (e) => handleAddOnSelection(addOn.id, e.target.checked));
                    
                    addonsSelectionContainer.appendChild(addOnElement);
                });
            } else {
                // English add-ons (original logic)
                addOns.forEach(addOn => {
                    const addOnElement = document.createElement('label');
                    addOnElement.className = `flex items-center bg-stone-100 p-4 rounded-lg cursor-pointer hover:bg-stone-200 transition-colors justify-between`;
                    
                    addOnElement.innerHTML = `
                        <div class="text-left">
                            <div class="addon-feature-link text-stone-700 hover:underline cursor-pointer feature-item" data-feature="${getAddonFeatureKey(addOn.id)}">
                                <span class="font-semibold">${addOn.name}</span>
                            </div>
                            <div class="text-sm text-stone-500">
                                +${addOn.priceOMR} OMR/mo
                            </div>
                        </div>
                        <input type="checkbox" data-addon-id="${addOn.id}" class="h-5 w-5 rounded text-teal-600 focus:ring-teal-500 border-stone-300">
                    `;
                    
                    // Add event listener for checkbox
                    const checkbox = addOnElement.querySelector('input');
                    checkbox.addEventListener('change', (e) => handleAddOnSelection(addOn.id, e.target.checked));
                    
                    addonsSelectionContainer.appendChild(addOnElement);
                });

                // Add event listeners for feature links in add-ons (English only)
                document.querySelectorAll('.addon-feature-link').forEach(link => {
                    link.addEventListener('click', (event) => {
                        event.preventDefault(); // Prevent default anchor behavior
                        const targetId = event.target.getAttribute('href'); // Get href attribute
                        const targetSection = document.querySelector(targetId);
                        if (targetSection) {
                            targetSection.scrollIntoView({ behavior: 'smooth' }); // Scroll to view
                        }
                    });
                });
            }
        }

        // Language functionality
        let currentLang = localStorage.getItem('chatoman_language') || 'en';

        function updateLanguageView(lang) {
            // Hide all language content first
            document.querySelectorAll('.lang-ar, .lang-en').forEach(el => {
                el.style.display = 'none';
            });

            // Show only the selected language content
            if (lang === 'ar') {
                document.querySelectorAll('.lang-ar').forEach(el => {
                    el.style.display = 'block';
                });
                // Update document direction for Arabic
                document.documentElement.setAttribute('dir', 'rtl');
                document.body.style.direction = 'rtl';
            } else {
                document.querySelectorAll('.lang-en').forEach(el => {
                    el.style.display = 'block';
                });
                // Update document direction for English
                document.documentElement.setAttribute('dir', 'ltr');
                document.body.style.direction = 'ltr';
            }

            // Update document language attribute
            document.documentElement.setAttribute('lang', lang);

            // Re-render pricing for the current language
            renderPricing(lang, currentBillingCycle[lang]);
            
            // Re-render add-ons for proper RTL formatting
            renderAddOns();
            
            updateDisplay();
        }

        function switchLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('chatoman_language', lang);

            // Update button text
            const langButton = document.getElementById('lang-button');
            langButton.textContent = lang.toUpperCase() + ' ▾';

            // Hide dropdown
            document.getElementById('lang-dropdown').classList.add('hidden');

            // Update language view
            updateLanguageView(lang);
        }

        // Modal elements
        const featureModal = document.getElementById('feature-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalCloseButton = document.getElementById('modal-close-button');

        // Feature popup elements
        const featurePopupModal = document.getElementById('feature-popup-modal');
        const featurePopupTitle = document.getElementById('feature-popup-title');
        const featurePopupContent = document.getElementById('feature-popup-content');
        const featurePopupCloseButton = document.getElementById('feature-popup-close-button');

        function openModal(title, content) {
            modalTitle.textContent = title;
            modalContent.innerHTML = content; // Changed to innerHTML
            featureModal.classList.add('show');
        }

        function closeModal() {
            modalTitle.textContent = ''; // Clear title
            modalContent.innerHTML = ''; // Clear content
            featureModal.classList.remove('show');
        }

        function openFeaturePopup(featureKey) {
            const lang = currentLang;
            const feature = featurePopupData[featureKey];
            
            if (!feature) return;
            
            featurePopupTitle.textContent = feature.title[lang];
            featurePopupContent.textContent = feature.description[lang];
            featurePopupModal.classList.add('show');
            
            // Prevent body scrolling
            document.body.style.overflow = 'hidden';
        }

        function closeFeaturePopup() {
            featurePopupModal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // Feature popup data - bilingual descriptions
        const featurePopupData = {
            'messages': {
                title: { en: 'Message Credits', ar: 'أرصدة الرسائل' },
                description: { 
                    en: 'Each time your AI chatbot replies to a customer, it uses one message credit. Plans include monthly credits that reset each billing cycle.',
                    ar: 'كل مرة يرد فيها روبوت الدردشة على العميل، يستخدم رصيد رسالة واحد. تتضمن الخطط أرصدة شهرية تتجدد كل دورة فوترة.'
                }
            },
            'agents': {
                title: { en: 'AI Agents', ar: 'الوكلاء الذكيين' },
                description: { 
                    en: 'An AI Agent is a distinct chatbot with its own knowledge base. Use separate agents for different purposes like sales, support, or bookings.',
                    ar: 'الوكيل الذكي هو روبوت دردشة منفصل بقاعدة معرفة خاصة به. استخدم وكلاء منفصلين لأغراض مختلفة كالمبيعات أو الدعم أو الحجوزات.'
                }
            },
            'basic-faq': {
                title: { en: 'Basic FAQ Support', ar: 'دعم الأسئلة الشائعة الأساسية' },
                description: { 
                    en: 'Initial setup of fundamental FAQs based on your business information, ensuring your chatbot can answer common customer questions.',
                    ar: 'إعداد أولي للأسئلة الشائعة الأساسية بناءً على معلومات عملك، مما يضمن قدرة روبوت الدردشة على الإجابة على أسئلة العملاء الشائعة.'
                }
            },
            'response-updates': {
                title: { en: 'Response Updates', ar: 'تحديثات الردود' },
                description: { 
                    en: 'Regular reviews and updates to your chatbot responses to ensure accuracy and keep information fresh and relevant.',
                    ar: 'مراجعات وتحديثات منتظمة لردود روبوت الدردشة لضمان الدقة والحفاظ على المعلومات طازجة ومتصلة بالواقع.'
                }
            },
            'chat-updates': {
                title: { en: 'Chat Updates Weekly', ar: 'تحديثات الدردشة أسبوعيًا' },
                description: { 
                    en: 'Weekly reviews and updates to your chatbot flows and responses for businesses with dynamic needs.',
                    ar: 'مراجعات وتحديثات أسبوعية لتدفقات وردود روبوت الدردشة للشركات ذات الاحتياجات الديناميكية.'
                }
            },
            'light-customization': {
                title: { en: 'Light Customization', ar: 'تخصيص خفيف' },
                description: { 
                    en: 'Basic customization of your chatbot personality and conversational flows to guide users through common interactions.',
                    ar: 'تخصيص أساسي لشخصية روبوت الدردشة وتدفقات المحادثة لتوجيه المستخدمين خلال التفاعلات الشائعة.'
                }
            },
            'full-personalization': {
                title: { en: 'Full Personalization', ar: 'التخصيص الكامل' },
                description: { 
                    en: 'Comprehensive customization including deep persona customization, advanced flows, and performance reviews.',
                    ar: 'تخصيص شامل يتضمن تخصيص عميق للشخصية، وتدفقات متقدمة، ومراجعات أداء.'
                }
            },
            'branding-removed': {
                title: { en: 'Branding Removed', ar: 'إزالة العلامة التجارية' },
                description: { 
                    en: 'Removes "Powered by" labels and third-party branding, making your chatbot look completely yours.',
                    ar: 'يزيل عبارات "مدعوم من" والعلامات التجارية للطرف الثالث، مما يجعل روبوت الدردشة يبدو ملكك بالكامل.'
                }
            },
            'custom-domain': {
                title: { en: 'Custom Domain', ar: 'نطاق مخصص' },
                description: { 
                    en: 'Host your chatbot on your own subdomain (e.g., bot.yourbusiness.com) for enhanced professionalism.',
                    ar: 'استضف روبوت الدردشة على نطاقك الفرعي (مثل bot.yourbusiness.com) لمزيد من الاحترافية.'
                }
            },
            'dedicated-manager': {
                title: { en: 'Dedicated Manager', ar: 'مدير مخصص' },
                description: { 
                    en: 'A dedicated manager oversees your chatbot performance and provides tailored recommendations.',
                    ar: 'مدير مخصص يشرف على أداء روبوت الدردشة ويقدم توصيات مخصصة.'
                }
            },
            'extra-credits': {
                title: { en: 'Extra Messages', ar: 'رسائل إضافية' },
                description: { 
                    en: 'Additional 1,000 message credits per month for high-volume customer interactions.',
                    ar: 'ألف رصيد رسالة إضافي شهريًا للتفاعلات عالية الحجم مع العملاء.'
                }
            },
            'whatsapp-integration': {
                title: { en: 'WhatsApp Integration', ar: 'تكامل واتساب' },
                description: { 
                    en: 'Connect your chatbot directly to WhatsApp so customers can chat on their preferred platform.',
                    ar: 'اربط روبوت الدردشة مباشرة بواتساب ليتمكن العملاء من الدردشة على منصتهم المفضلة.'
                }
            },
            'performance-report': {
                title: { en: 'Performance Report', ar: 'تقرير الأداء' },
                description: { 
                    en: 'Monthly reports detailing chatbot performance, message volume, and user satisfaction metrics.',
                    ar: 'تقارير شهرية توضح أداء روبوت الدردشة، وحجم الرسائل، ومقاييس رضا المستخدمين.'
                }
            },
            'extra-agent': {
                title: { en: 'Extra AI Agent', ar: 'وكيل ذكاء اصطناعي إضافي' },
                description: { 
                    en: 'Additional AI agent for handling different aspects of your business with separate knowledge bases.',
                    ar: 'وكيل ذكاء اصطناعي إضافي للتعامل مع جوانب مختلفة من عملك بقواعد معرفة منفصلة.'
                }
            },
            'pro-insights-pack': {
                title: { en: 'Pro Insights Pack', ar: 'حزمة رؤى المحترفين' },
                description: { 
                    en: 'Bundle including Performance Report and Branding Removal for enhanced insights and professional appearance.',
                    ar: 'حزمة تتضمن تقرير الأداء وإزالة العلامة التجارية للحصول على رؤى محسّنة ومظهر احترافي.'
                }
            },
            'elite-brand-scale': {
                title: { en: 'Elite Brand & Scale Kit', ar: 'حزمة النخبة للعلامة التجارية والتوسع' },
                description: { 
                    en: 'Comprehensive bundle with extra messages, branding removal, and custom domain for scaling businesses.',
                    ar: 'حزمة شاملة مع رسائل إضافية، وإزالة العلامة التجارية، ونطاق مخصص للشركات المتنامية.'
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize language button text
            const langButton = document.getElementById('lang-button');
            langButton.textContent = currentLang.toUpperCase() + ' ▾';

            // Language toggle functionality
            const langDropdown = document.getElementById('lang-dropdown');
            const langOptions = document.querySelectorAll('.lang-option');

            // Toggle dropdown
            langButton.addEventListener('click', (e) => {
                e.stopPropagation();
                langDropdown.classList.toggle('hidden');
            });

            // Language selection
            langOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const selectedLang = option.getAttribute('data-lang');
                    switchLanguage(selectedLang);
                });
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                langDropdown.classList.add('hidden');
            });

            // Prevent dropdown from closing when clicking inside it
            langDropdown.addEventListener('click', (e) => {
                e.stopPropagation();
            });

            // Initialize pricing for both languages
            ['en', 'ar'].forEach(lang => {
                renderPricing(lang, 'monthly'); // Default to monthly
                setupBillingToggle(lang);
            });

            // Initialize with the current language
            updateLanguageView(currentLang);

            // Initialize add-ons
            renderAddOns();

            // Create English accordion
            const accordionContainerEN = document.getElementById('accordion-container-en');
            featureExplanationsEN.forEach((item, index) => {
                const accordionItem = document.createElement('div');
                accordionItem.className = 'bg-white rounded-xl shadow-sm';
                accordionItem.innerHTML = `
                    <button class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-left">
                        <span>${item.title}</span>
                        <span class="transform transition-transform duration-300">▼</span>
                    </button>
                    <div class="accordion-content px-5 pb-5 text-stone-600">
                        <div>${item.content}</div>
                    </div>
                `;
                const toggle = accordionItem.querySelector('.accordion-toggle');
                const content = accordionItem.querySelector('.accordion-content');
                const arrow = accordionItem.querySelector('span:last-child');

                toggle.addEventListener('click', () => {
                    const isOpen = content.style.maxHeight;
                    if (isOpen && isOpen !== '0px') {
                        content.style.maxHeight = '0px';
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        arrow.style.transform = 'rotate(180deg)';
                    }
                });

                accordionContainerEN.appendChild(accordionItem);
            });

            // Create Arabic accordion
            const accordionContainerAR = document.getElementById('accordion-container-ar');
            featureExplanationsAR.forEach((item, index) => {
                const accordionItem = document.createElement('div');
                accordionItem.className = 'bg-white rounded-xl shadow-sm';
                accordionItem.style.direction = 'rtl';
                accordionItem.style.textAlign = 'right';
                accordionItem.innerHTML = `
                    <button class="accordion-toggle flex justify-between items-center w-full p-5 font-semibold text-right font-tajawal" style="direction: rtl; text-align: right;">
                        <span class="transform transition-transform duration-300">▼</span>
                        <span>${item.title}</span>
                    </button>
                    <div class="accordion-content px-5 pb-5 text-stone-600 font-tajawal" style="direction: rtl; text-align: right;">
                        <div>${item.content}</div>
                    </div>
                `;
                const toggle = accordionItem.querySelector('.accordion-toggle');
                const content = accordionItem.querySelector('.accordion-content');
                const arrow = accordionItem.querySelector('span:first-child');

                toggle.addEventListener('click', () => {
                    const isOpen = content.style.maxHeight;
                    if (isOpen && isOpen !== '0px') {
                        content.style.maxHeight = '0px';
                        arrow.style.transform = 'rotate(0deg)';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        arrow.style.transform = 'rotate(180deg)';
                    }
                });

                accordionContainerAR.appendChild(accordionItem);
            });

            // Close modal events
            modalCloseButton.addEventListener('click', closeModal);
            featureModal.addEventListener('click', (event) => {
                if (event.target === featureModal) { // Close only if clicking on the overlay, not the content
                    closeModal();
                }
            });

            // Feature popup modal events
            featurePopupCloseButton.addEventListener('click', closeFeaturePopup);
            featurePopupModal.addEventListener('click', (event) => {
                if (event.target === featurePopupModal) {
                    closeFeaturePopup();
                }
            });

            // Add feature popup listeners to add-ons after rendering
            document.addEventListener('click', (e) => {
                if (e.target.closest('.feature-item')) {
                    const featureItem = e.target.closest('.feature-item');
                    const featureKey = featureItem.dataset.feature;
                    if (featureKey) {
                        e.stopPropagation();
                        openFeaturePopup(featureKey);
                    }
                }
            });

            updateDisplay();

            // Run language audit after everything is loaded
            setTimeout(() => {
                auditLanguageSeparation();
            }, 1000);

            // Test function for language switching and pricing
            window.testLanguageAndPricing = function() {
                console.log('Testing Arabic view with monthly pricing...');
                switchLanguage('ar');
                isYearly = false;
                monthlyToggle.classList.add('active');
                yearlyToggle.classList.remove('active');
                toggleSlider.classList.remove('yearly');
                renderPlanCards();
                updateDisplay();
                updateLanguageView('ar');

                setTimeout(() => {
                    console.log('Testing Arabic view with yearly pricing...');
                    isYearly = true;
                    yearlyToggle.classList.add('active');
                    monthlyToggle.classList.remove('active');
                    toggleSlider.classList.add('yearly');
                    renderPlanCards();
                    updateDisplay();

                    setTimeout(() => {
                        console.log('Testing English view with monthly pricing...');
                        switchLanguage('en');
                        isYearly = false;
                        monthlyToggle.classList.add('active');
                        yearlyToggle.classList.remove('active');
                        toggleSlider.classList.remove('yearly');
                        renderPlanCards();
                        updateDisplay();
                        updateLanguageView('en');

                        setTimeout(() => {
                            console.log('Testing English view with yearly pricing...');
                            isYearly = true;
                            yearlyToggle.classList.add('active');
                            monthlyToggle.classList.remove('active');
                            toggleSlider.classList.add('yearly');
                            renderPlanCards();
                            updateDisplay();

                            console.log('All tests complete. Run auditLanguageSeparation() to check for issues.');
                            auditLanguageSeparation();
                        }, 1000);
                    }, 1000);
                }, 1000);
            };

            console.log('Use testLanguageAndPricing() to test all language/pricing combinations');

            // LLM Feature Logic for FAQ Generator - English
            const businessTypeInput = document.getElementById('business-type-input');
            const generateFaqBtn = document.getElementById('generate-faq-btn');
            const faqLoadingIndicator = document.getElementById('faq-loading-indicator');
            const generatedFaqsDiv = document.getElementById('generated-faqs');

            // LLM Feature Logic for FAQ Generator - Arabic
            const businessTypeInputAr = document.getElementById('business-type-input-ar');
            const generateFaqBtnAr = document.getElementById('generate-faq-btn-ar');
            const faqLoadingIndicatorAr = document.getElementById('faq-loading-indicator-ar');
            const generatedFaqsDivAr = document.getElementById('generated-faqs-ar');

            async function generateFAQs(businessType, loadingEl, outputEl) {
                if (!businessType) {
                    outputEl.textContent = "Please enter a business type to generate FAQs.";
                    return;
                }

                loadingEl.classList.remove('hidden');
                outputEl.textContent = ""; // Clear previous FAQs

                const prompt = `Generate a list of 8-10 common Frequently Asked Questions (FAQs) for a business that is a ${businessType}. Format them as a numbered list with a question followed by a short, concise answer.`;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();

                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        outputEl.textContent = text;
                    } else {
                        outputEl.textContent = "Could not generate FAQs. Please try again or refine your business type.";
                    }
                } catch (error) {
                    console.error("Error generating FAQs:", error);
                    outputEl.textContent = "An error occurred while generating FAQs. Please try again.";
                } finally {
                    loadingEl.classList.add('hidden');
                }
            }

            generateFaqBtn.addEventListener('click', async () => {
                const businessType = businessTypeInput.value.trim();
                await generateFAQs(businessType, faqLoadingIndicator, generatedFaqsDiv);
            });

            generateFaqBtnAr.addEventListener('click', async () => {
                const businessType = businessTypeInputAr.value.trim();
                await generateFAQs(businessType, faqLoadingIndicatorAr, generatedFaqsDivAr);
            });

            // Link "Get Started" buttons to Google Form
            document.getElementById('get-started-btn-static').addEventListener('click', () => {
                if (!googleFormURL) { 
                    console.error("Google Form URL is not set. Please provide a valid Google Form URL.");
                    return;
                }
                window.open(googleFormURL, '_blank');
            });

            document.getElementById('get-started-btn-static-ar').addEventListener('click', () => {
                if (!googleFormURL) { 
                    console.error("Google Form URL is not set. Please provide a valid Google Form URL.");
                    return;
                }
                window.open(googleFormURL, '_blank');
            });

            document.getElementById('sticky-get-started').addEventListener('click', () => {
                if (!googleFormURL) { 
                    console.error("Google Form URL is not set. Please provide a valid Google Form URL.");
                    return;
                }
                window.open(googleFormURL, '_blank');
            });

            // Link "Get Started" button under "How It Works" to Google Form
            document.getElementById('how-it-works-get-started-btn').addEventListener('click', () => {
                if (!googleFormURL) { 
                    console.error("Google Form URL is not set. Please provide a valid Google Form URL.");
                    return;
                }
                window.open(googleFormURL, '_blank');
            });

            document.getElementById('how-it-works-get-started-btn-ar').addEventListener('click', () => {
                if (!googleFormURL) { 
                    console.error("Google Form URL is not set. Please provide a valid Google Form URL.");
                    return;
                }
                window.open(googleFormURL, '_blank');
            });

            // Link "See How It Works" button to "How It Works" section
            document.getElementById('hero-get-started-btn').addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default anchor behavior
                const howItWorksSection = document.getElementById('how-it-works');
                if (howItWorksSection) {
                    howItWorksSection.scrollIntoView({ behavior: 'smooth' });
                }
            });

            document.getElementById('hero-get-started-btn-ar').addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default anchor behavior
                const howItWorksSection = document.getElementById('how-it-works');
                if (howItWorksSection) {
                    howItWorksSection.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        function handlePlanSelection(planId) {
            selectedPlanId = planId;
            // Update selection visual state for all cards
            document.querySelectorAll('.plan-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.planId === planId);
            });
            updateDisplay();
        }

        function handleAddOnSelection(addOnId, isSelected) {
            if (isSelected) {
                selectedAddOnIds.add(addOnId);
            } else {
                selectedAddOnIds.delete(addOnId);
            }
            updateDisplay();
        }

        function updateDisplay() {
            // Calculate totals for both languages
            const calculations = {};

            ['en', 'ar'].forEach(lang => {
                let total = 0;
                let setupFee = 0;
                const isYearly = currentBillingCycle[lang] === 'yearly';

                // Add plan price
                if (selectedPlanId) {
                    const plan = pricingData.find(p => p.id === selectedPlanId);
                    if (plan) {
                        total += isYearly ? plan.price.yearly : plan.price.monthly;
                        setupFee = isYearly ? plan.setupFee.yearly : plan.setupFee.monthly;
                    }
                }

                // Add add-on prices
                selectedAddOnIds.forEach(addOnId => {
                    const addOn = addOns.find(a => a.id === addOnId);
                    if (addOn) {
                        // For yearly billing, multiply add-on price by 12
                        total += isYearly ? (addOn.priceOMR * 12) : addOn.priceOMR; 
                    }
                });

                calculations[lang] = { total, setupFee, isYearly };
            });

            // Update English displays
            const totalPriceDisplay = document.getElementById('total-price-display');
            const setupFeeDisplay = document.getElementById('setup-fee-display');
            const totalLabelEn = document.getElementById('total-label-en');

            if (totalPriceDisplay) totalPriceDisplay.textContent = `${calculations.en.total} OMR`;
            if (setupFeeDisplay) setupFeeDisplay.textContent = `${calculations.en.setupFee} OMR`;
            if (totalLabelEn) totalLabelEn.textContent = calculations.en.isYearly ? 'Yearly Total:' : 'Monthly Total:';

            // Update Arabic displays
            const totalPriceDisplayAr = document.getElementById('total-price-display-ar');
            const setupFeeDisplayAr = document.getElementById('setup-fee-display-ar');
            const totalLabelAr = document.getElementById('total-label-ar');

            if (totalPriceDisplayAr) totalPriceDisplayAr.textContent = `${arabicDigits(calculations.ar.total)} ريال عماني`;
            if (setupFeeDisplayAr) setupFeeDisplayAr.textContent = `${arabicDigits(calculations.ar.setupFee)} ريال عماني`;
            if (totalLabelAr) totalLabelAr.textContent = calculations.ar.isYearly ? 'الإجمالي السنوي:' : 'الإجمالي الشهري:';
        }
    </script>
    <!-- Chatbase chatbot integration script -->
    <script>
        (function(){if(!window.chatbase||window.chatbase("getState")!=="initialized"){window.chatbase=(...arguments)=>{if(!window.chatbase.q){window.chatbase.q=[]}window.chatbase.q.push(arguments)};window.chatbase=new Proxy(window.chatbase,{get(target,prop){if(prop==="q"){return target.q}return(...args)=>target(prop,...args)}})}const onLoad=function(){const script=document.createElement("script");script.src="https://www.chatbase.co/embed.min.js";script.id="Qnz7C2BIzWuvbfBOx_maY";script.domain="www.chatbase.co";document.body.appendChild(script)};if(document.readyState==="complete"){onLoad()}else{window.addEventListener("load",onLoad)}})();
    </script>
</body>
</html>
